---
title: 数据订阅
description: 数据订阅的基本概念
---

为了将 TDengine 的数据分发给其他应用程序，TDengine 提供了类似 kafka 的数据订阅功能。这样在很多场景下，采用 TDengine 的时序数据处理系统不再需要集成消息队列产品，比如 kafka, 从而简化系统设计的复杂度，降低运营维护成本。

## 简介

TDengine 的数据订阅功能，采取生产者-消费者模型：

- **生产者（Producer）**：产生数据的源头，在 TDengine 中，所有被订阅的表、数据库都可以视为数据生产者
- **主题（Topic）**：生产者产生的数据，会被放入某个的主题，供消费者获取
- **消费者（Consumer）**：消费者可以订阅（Subscribe）主题，并获取（消费）该主题下的数据
- **消费者组（Consumer Group）**：每个消费者都属于某个消费者组，消费者组可包含多个消费者
- **订阅（Subscription）**：消费者需要先订阅相关主题，才能获取该主题下的数据

## 主题

每个主题都包含一定的过滤条件，用于判断生产者产生的数据是否属于该主题。例如：

```sql
CREATE TOPIC high_voltage AS SELECT * FROM test.d100 WHERE voltage>9;
```

上述命令创建了一个名为 `high_voltage` 的主题。`AS SELECT ...` 通过一个 SQL 查询语句，定义了生产者（`test.d100`）和主题的过滤条件（`FROM test.d100 WHERE voltage>9`）。在主题成功创建后，所有新写入 `test.d100` 并满足过滤条件的数据，都属于 `high_voltage` 主题。

利用 SELECT 订阅主题，可以实现对特定查询结果的订阅。除此之外，还可以对整个表、整个数据库进行订阅。

## 数据消费

在客户端，应用程序创建消费者，消费者可以订阅主题，并获取该主题下的数据。消费者会保存消费进度，从而保障不重复地获取数据，与最新的数据集对齐。

## 更多内容

本文仅对数据订阅做简要介绍，更为详细的使用说明，请参考[开发指南](../../dev/tmq)。