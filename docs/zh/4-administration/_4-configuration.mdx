---
title: 服务端配置
description: 对 TDengine 集群进行配置
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

export const ToServerConf = ()=>(<a heref="../reference/cofiguration-parameters">「配置参数」</a>);
export const ToServerArchitecture = ()=>(<a href="./server-architecture">「服务端架构」</a>);
export const ToAdapter = ()=>(<a heref="../service-and-executable/taosadapter">「taosadapter」</a>);
export const ToKeeper = ()=>(<a heref="../service-and-executable/taoskeeper">「taoskeeper」</a>);
export const ToIns = ()=>(<a href="../taos-sql/meta">「information_schema」</a>);

本文介绍服务端的配置参数修改方式，并介绍一些重要的配置项。

## 服务端配置文件 {#config_file}

服务端的配置参数主要由 `taos.cfg` 管理：

- `/usr/local/taos/cfg/taos.cfg`：服务端配置参数文件，涉及服务端的各种服务，其中的部分参数在客户端也有效，详见<ToServerConf/>

修改上述配置文件后，需重启服务，以使配置生效。

如需使用 taosadapter、taoskeeper，还会涉及以下文件的修改：

- `/usr/local/taos/cfg/taosadapter.toml`：taosadapter 配置文件，详见<ToAdapter/>
- `/etc/taos/taoskeeper.toml`：taoskeeper 配置文件，详见<ToKeeper/>

## 全局配置参数

每个 `taos.cfg`，仅对本机所部署的节点生效，因此，节点直接可以配置不同参数。但是以下参数，必须在**所有节点**保持一致：

| 配置参数 | 含义 |
| --- | --- |
| `statusInterval` | dnode 向 mnode 报告状态时长 |
| `timezone` | 时区 |
| `locale` | 系统区位信息及编码格式 |
| `charset` | 字符集编码 |
| `ttlChangeOnWrite` | ttl 到期时间是否伴随表的修改操作改变 |

## FQDN 配置 {#fqdn}

在 TDengine 中，每个节点都通过唯一的 EP（Endpoint）进行标识，集群内部/外部通过 EP 来访问节点。EP 由 FQDN 和端口号组成，例如 `d1.tdengine.com:6030` 由 FDQN `d1.tdengine.com` 和端口号 `6030` 组成。

EP 中的 FQDN 需转换为 IP 才能通过 TPC/IP 进行通信，这一工作可由 DNS（Domain Name System）完成。如没有 DNS 系统，则通过配置 host 文件来完成，下文介绍 host 文件配置方式：

**1 - 配置本机 FQDN**：对于**每个**服务端节点，在 `/etc/hostname` 中添加本节点的 FQDN，并重启系统。例如：

```bash title="/etc/hostname"
node1
```

如果物理节点的 `/etc/hostname` 包含多行内容，则需要同时修改 `taos.cfg` 中的参数 `fqdn` 来明确 TDengine 节点所使用的 FDQN。例如：

```bash title="/etc/hostname"
node1
other.fqdn1
other.fqdn2
```

```bash title="/usr/local/taos/cfg/taos.cfg"
fqdn                  node1
```

如果 `/etc/hostname` 只有一行内容，则无需该操作。

**2 - 配置 FQDN 解析规则**：对于**每个**节点（包括客户端节点），在 `/etc/hosts` 中添加集群中所有节点的 IP 与 FQDN 映射关系：

```bash title="/etc/hosts"
10.211.55.14 node1
10.211.55.15 node2
10.211.55.16 node3
```

使用 FQDN 进行内部/外部访问，便于维持统一的接口名称：当 IP 地址发生改变时，只需对 host 文件或 DNS 服务器进行修改，无需对集群和应用程序进行修改，便于集群服务的管理。因此，尽管可以直接使用 IP 地址进行访问，在生产环境下，我们仍然建议使用 FQDN。